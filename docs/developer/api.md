# API Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Telegram-Ð±Ð¾Ñ‚Ð° Ð”Ð½ÐµÐ²Ð½Ð¸ÐºÐ° Ð¡Ð°Ð¼Ð¾Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ñ

## ÐžÐ±Ñ‰Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ

Ð­Ñ‚Ð¾Ñ‚ Telegram-Ð±Ð¾Ñ‚ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ Ð²ÐµÑÑ‚Ð¸ Ð´Ð½ÐµÐ²Ð½Ð¸Ðº ÑÐ°Ð¼Ð¾Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ñ Ð¸ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ñ‘Ð¼Ñ‹ Ð¿Ð¸Ñ‰Ð¸. Ð’Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ñ‡ÐµÑ€ÐµÐ· ÐºÐ½Ð¾Ð¿ÐºÐ¸ Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ. Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÑŽÑ‚ÑÑ Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ ÐºÐ¾Ð½ÐµÑ‡Ð½Ð¾Ð³Ð¾ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð° ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ð¹ (FSM).

---

## Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ FSM

| Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ                      | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ                                     |
|-------------------------------|----------------------------------------------|
| STATE_NONE                    | ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ðµ/Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ                |
| STATE_WRITING_SITUATION       | Ð’Ð²Ð¾Ð´ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸Ð¸                       |
| STATE_WRITING_THOUGHTS        | Ð’Ð²Ð¾Ð´ Ð¼Ñ‹ÑÐ»ÐµÐ¹                                  |
| STATE_WRITING_EMOTIONS        | Ð’Ñ‹Ð±Ð¾Ñ€ ÑÐ¼Ð¾Ñ†Ð¸Ð¹ Ð¸Ð· ÐºÐ½Ð¾Ð¿Ð¾Ñ‡Ð½Ð¾Ð¹ ÐºÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ñ‹         |
| STATE_WRITING_SENSATIONS      | Ð’Ð²Ð¾Ð´ Ñ‚ÐµÐ»ÐµÑÐ½Ñ‹Ñ… Ð¾Ñ‰ÑƒÑ‰ÐµÐ½Ð¸Ð¹                       |
| STATE_WRITING_ACTIONS         | Ð’Ð²Ð¾Ð´ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹                                |
| STATE_WRITING_DESIRES         | Ð’Ð²Ð¾Ð´ Ð¶ÐµÐ»Ð°Ð½Ð¸Ð¹                                 |
| STATE_WRITING_MEALS_COUNT     | Ð’Ð²Ð¾Ð´ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð¿Ñ€Ð¸ÐµÐ¼Ð¾Ð² Ð¿Ð¸Ñ‰Ð¸                 |
| STATE_WRITING_MEALS_COMMENT   | Ð’Ð²Ð¾Ð´ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸ÐµÐ² Ðº Ð¿Ð¸Ñ‚Ð°Ð½Ð¸ÑŽ                  |
| STATE_SELECTING_REPORT_DATE   | Ð’Ð²Ð¾Ð´ Ð´Ð°Ñ‚Ñ‹ Ð´Ð»Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð°               |

---

## ÐšÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð±Ð¾Ñ‚Ð°

| ÐšÐ¾Ð¼Ð°Ð½Ð´Ð°     | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ                              |
|-------------|---------------------------------------|
| `/start`    | Ð—Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð° Ð¸ Ð¿Ð¾ÐºÐ°Ð· Ð³Ð»Ð°Ð²Ð½Ð¾Ð³Ð¾ Ð¼ÐµÐ½ÑŽ     |
| `/help`     | ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ      |
| `/cancel`   | ÐžÑ‚Ð¼ÐµÐ½ÑÐµÑ‚ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ             |
| `/reset`    | Ð¡Ð±Ñ€Ð¾Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ          |

---

## ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ð¼ Ð¼ÐµÐ½ÑŽ

| Ð¢ÐµÐºÑÑ‚ ÐºÐ½Ð¾Ð¿ÐºÐ¸        | Callback data      | Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ                                           |
|---------------------|--------------------|----------------------------------------------------|
| ðŸ“ Ð—Ð°Ð¿Ð¸ÑÑŒ Ð² Ð´Ð½ÐµÐ²Ð½Ð¸Ðº | `journal_entry`    | ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ°                             |
| ðŸŽ ÐŸÐ¸Ñ‚Ð°Ð½Ð¸Ðµ           | `meals_entry`      | Ð—Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€Ð¸Ñ‘Ð¼Ð¾Ð² Ð¿Ð¸Ñ‰Ð¸ Ð¸ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹     |
| ðŸ“Š ÐžÑ‚Ñ‡Ñ‘Ñ‚ Ð·Ð° Ð´ÐµÐ½ÑŒ     | `daily_report`     | Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð° Ð·Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð´Ð°Ñ‚Ñƒ                    |
| â„¹ï¸ ÐŸÐ¾Ð¼Ð¾Ñ‰ÑŒ            | `help`             | ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÑÐ¿Ñ€Ð°Ð²ÐºÑƒ                                   |

---

## Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…

### Journal Entry

```json
{
  "user_id": 123456789,
  "date": "2025-05-28",
  "situation": "Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ",
  "thoughts": "Ð¼Ñ‹ÑÐ»Ð¸",
  "emotions": "Ñ€Ð°Ð´Ð¾ÑÑ‚ÑŒ, Ð²Ð´Ð¾Ñ…Ð½Ð¾Ð²ÐµÐ½Ð¸Ðµ",
  "sensations": "Ð¾Ñ‰ÑƒÑ‰ÐµÐ½Ð¸Ñ",
  "actions": "Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",
  "desires": "Ð¶ÐµÐ»Ð°Ð½Ð¸Ñ"
}
```

# âš™ï¸ ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹

## 1. FSM: Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÑÐ¼Ð¸
Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ (`state`) Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÑŽÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· `context.user_data['state']`.  
ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ñ‹ Ð¼ÐµÐ¶Ð´Ñƒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÑÐ¼Ð¸ Ð¾ÑÑƒÑ‰ÐµÑÑ‚Ð²Ð»ÑÑŽÑ‚ÑÑ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ Ð²Ð²Ð¾Ð´Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸ callback-Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð².

## 2. ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸

| Ð¥ÐµÐ½Ð´Ð»ÐµÑ€                       | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ                                |
|------------------------------|--------------------------------------------|
| `start()`                    | ÐŸÑ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð¸ Ð¿Ð¾ÐºÐ°Ð· Ð³Ð»Ð°Ð²Ð½Ð¾Ð³Ð¾ Ð¼ÐµÐ½ÑŽ          |
| `button_handler()`           | ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° inline-ÐºÐ½Ð¾Ð¿Ð¾Ðº                    |
| `handle_journal_entry()`     | FSM-Ð²Ð²Ð¾Ð´ Ð´Ð»Ñ Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ°                      |
| `handle_meals_entry()`       | FSM-Ð²Ð²Ð¾Ð´ Ð´Ð»Ñ Ð¿Ð¸Ñ‚Ð°Ð½Ð¸Ñ                       |
| `handle_report_date_selection()` | ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ð²Ð¾Ð´Ð° Ð´Ð°Ñ‚Ñ‹                  |
| `send_daily_report()`        | Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ   |
| `cancel()`                   | ÐžÑ‚Ð¼ÐµÐ½Ð° Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ Ð¸ Ð¾Ñ‡Ð¸ÑÑ‚ÐºÐ° ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ        |
| `reset()`                    | ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÐ±Ñ€Ð¾Ñ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ|

---

# ðŸ›¢ï¸ Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð±Ð°Ð·Ð¾Ð¹ Ð´Ð°Ð½Ð½Ñ‹Ñ…

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ **SQLite**. Ð¢Ð°Ð±Ð»Ð¸Ñ†Ñ‹:

- `journal_entries` â€” Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ°  
- `meal_entries` â€” Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¿Ð¸Ñ‚Ð°Ð½Ð¸Ñ

```sql
CREATE TABLE journal_entries (
  id INTEGER PRIMARY KEY,
  user_id INTEGER,
  date TEXT,
  situation TEXT,
  thoughts TEXT,
  emotions TEXT,
  sensations TEXT,
  actions TEXT,
  desires TEXT
);

CREATE TABLE meal_entries (
  id INTEGER PRIMARY KEY,
  user_id INTEGER,
  date TEXT,
  meals_count INTEGER,
  comments TEXT
);
```

# ðŸ“± ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ `InlineKeyboardMarkup` Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°Ð¼Ð¸:

- Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ 
- Ð’Ñ‹Ð±Ð¾Ñ€ ÑÐ¼Ð¾Ñ†Ð¸Ð¹ (Ð³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð¸ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ð²Ñ‹Ð±Ð¾Ñ€)
- ÐžÑ‚Ñ‡Ñ‘Ñ‚ Ð¿Ð¾ Ð´Ð°Ñ‚Ð°Ð¼
- 
# âœ… ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ Ð²Ð²Ð¾Ð´Ð° Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð°Ñ‚Ñ‹)
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `context.user_data` Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð¼ÐµÐ¶ÑƒÑ‚Ð¾Ñ‡Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… 
- ÐžÑ‚Ñ‡Ñ‘Ñ‚Ð½Ñ‹Ð¹ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ Ð¿Ð¾ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð´Ð°Ñ‚Ðµ

# ðŸ”§ Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ
- Ð¥Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¸ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÐµÐ¹ 
- Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð¾Ð² (Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¸, Ð°Ð½Ð°Ð»Ð¸Ð·)
- ÐœÑƒÐ»ÑŒÑ‚Ð¸Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° 
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð¼ÑƒÐ»ÑŒÑ‚Ð¸ÑÐ·Ñ‹Ñ‡Ð½Ð¾ÑÑ‚Ð¸ 
- Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…

# ðŸ“Œ Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
`python-telegram-bot >= 20.x`
`sqlite3`
`logging`
